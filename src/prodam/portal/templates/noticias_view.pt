<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="prodam.portal">

  <body>
    <metal:content-core fill-slot="main">
      <metal:block define-macro="main">
        <header class="titulo_principal">
          <h1>Notícias</h1>
        </header>
        <article>
          <header tal:define="portal_url context/portal_url;">
            <div class="btn_voltar">
              <a href="#" tal:attributes="href python:portal_url + '/noticia'"><span></span> Voltar</a>
            </div>
            <h1 tal:content="context/Title | nothing">Template de notícias</h1>
            <h2 tal:content="context/Description | nothing">Descrição</h2>
            <div class="noticias_media">

              <tal:published tal:define="wtool context/portal_workflow;
                                         state context/review_state | python: wtool.getInfoFor(context, 'review_state', '')"
                             tal:condition="python:state == 'published'">
                <time tal:define="date context/EffectiveDate;
                                  data python:DateTime(date).strftime('%d/%m/%Y');
                                  hora python:DateTime(date).strftime('%H:%M')"
                      tal:content="python:hora + ' ' + data" />
              </tal:published>

              <div class="autor">De <strong tal:content="context/autor | nothing" /></div>
              <div class="noticias_media_col2">
                <div class="noticias_actions">
                  <ul>
                    <li><a href="#" class="aumentar_fonte">A+</a></li>
                    <li><a href="#" class="diminuir_fonte">A-</a></li>
                  </ul>
                </div>
                <div class="social_share">
                  <div tal:replace="structure provider:plone.belowcontenttitle" />
                </div>
              </div>
            </div>
          </header>
          <div class="contentBody" tal:define="texto context/text/raw | nothing">
            <p tal:replace="structure texto">Conteúdo</p>
          </div>
          <div id="galeriaImagem" tal:define="catalog python:context.portal_catalog;
                                              path python:'/'.join(context.getPhysicalPath());
                                              images python:catalog(path=path,portal_type='Image')"
                                  tal:condition="images">
            <script src="++resource++prodam.portal/js/gallery/jquery.tmpl.min.js"></script>
            <script src="++resource++prodam.portal/js/gallery/jquery.elastislide.js"></script>
            <script src="++resource++prodam.portal/js/gallery/jquery.easing.1.3.js"></script>
            <script src="++resource++prodam.portal/js/gallery/gallery.js"></script>
            <script>
              //AUTOPLAY GALLERY
              var t;
              var timer_is_on=0;

              function timedCount()
              {
              $('.rg-image-nav-next').click()
              t=setTimeout("timedCount()",1000);
              }

              function doTimer()
              {
              if (!timer_is_on)
              {
              timer_is_on=1;
              timedCount(1000);
              }
              }

              function stopCount()
              {
              clearTimeout(t);
              timer_is_on=0;
              }
            </script>
            <div id="image_links">
              <h4>Imagens para download</h4>
              <tal:links tal:repeat="img images">
                <a href="" tal:attributes="href python:img.absolute_url() + '/view'" tal:content="string:Foto ${repeat/img/number}" />
                <span tal:condition="not:repeat/img/end" tal:content="string: |" />
              </tal:links>
            </div>

            <script id="img-wrapper-tmpl" type="text/x-jquery-tmpl">
              <div class="rg-image-wrapper">
                {{if itemsCount > 1}}
                  <div class="rg-image-nav">
                    <a href="#" class="rg-image-nav-prev">Previous Image</a>
                    <a href="#" class="rg-image-nav-next">Next Image</a>
                  </div>
                {{/if}}
                <div class="rg-image"></div>
                <div class="rg-loading"></div>
                <div class="rg-caption-wrapper">
                  <div class="rg-caption" style="display:none;">
                    <p></p>
                  </div>
                </div>
              </div>
            </script>



            <div id="rg-gallery" class="rg-gallery">
              <div class="rg-thumbs">
                <div class="es-carousel-wrapper">
                  <div class="es-nav">
                    <span class="es-nav-prev">Previous</span>
                    <span class="es-nav-next">Next</span>
                  </div>
                  <div class="es-carousel">
                    <ul tal:attributes="data-size python:len(images)">
                      <tal:images tal:repeat="img images">
                        <li tal:attributes="data-current repeat/img/number;"><a href="#" tal:define="scales python:img.getObject().restrictedTraverse('@@images');
                                                    thumbnail python:scales.scale('image', width=100, height=66);
                                                    large python:scales.scale('image', scale='large')">
                          <img src="thumbs.png" data-large="large.jpg" alt="image01" data-description=""
                               tal:attributes="src thumbnail/url;
                                               data-large large/url;
                                               alt img/Title;
                                               data-description img/Description" />
                          <span class="descricao" tal:content="structure img/Description" />
                          <tal:hasAutor tal:condition="python:img.getObject().autor">
                            <span class="autor" tal:content="python:img.getObject().autor">
                          </tal:hasAutor>
                        </a></li>
                      </tal:images>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <span class="counterThumbs"></span>
            <div class="playbutton">
                      <a href="javascript:doTimer();">
                        Slideshow</a>
                    </div>
                    <div class="pausebutton">
                      <a href="javascript:stopCount();">Parar</a>
                    </div>

          </div>

          <script>

              //COUNTER THUMBS
              var totalThumbs = $('.es-carousel ul').attr('data-size');
              var thumbAtual = "<span class='thumbAtual'>1</span>";
              var totalThumbs = $( ".es-carousel ul li" ).length;
              $( ".counterThumbs" ).html(thumbAtual + "/" + totalThumbs );

          </script>


          <div tal:replace="structure provider:plone.belowcontentbody" />
        </article>
      </metal:block>
    </metal:content-core>
  </body>

</html>
